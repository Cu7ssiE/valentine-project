<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For You ❤️</title>
    <link
        href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=Lato:wght@300;400&display=swap"
        rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        /* --- Reset & Base --- */
        body {
            margin: 0;
            padding: 0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            /* Lighter background to let pink envelope pop */
            background: radial-gradient(circle at center, #fff0f5 0%, #fce4ec 100%);
            font-family: 'Playfair Display', serif;
            overflow: hidden;
            perspective: 1500px;
            /* Essential for 3D effect */
        }

        /* --- Container --- */
        .container {
            position: relative;
            z-index: 10;
        }

        /* --- Envelope Wrapper (For Tilt & Float) --- */
        .envelope-wrapper {
            position: relative;
            width: 320px;
            height: 220px;
            cursor: pointer;
            transition: transform 0.1s ease-out;
            /* Smooth tilt */
            /* Smooth tilt */
            animation: float 6s ease-in-out infinite, heartbeat 1.5s ease-in-out infinite;
            transform-style: preserve-3d;
        }

        @keyframes heartbeat {
            0% {
                transform: scale(1);
            }

            15% {
                transform: scale(1.02);
            }

            30% {
                transform: scale(1);
            }

            45% {
                transform: scale(1.02);
            }

            60% {
                transform: scale(1);
            }

            100% {
                transform: scale(1);
            }
        }

        /* Float Animation */
        @keyframes float {

            0%,
            100% {
                transform: translateY(0);
            }

            50% {
                transform: translateY(-15px);
            }
        }

        /* --- The Envelope --- */
        .envelope {
            position: relative;
            width: 100%;
            height: 100%;
            transform-style: preserve-3d;
        }

        /* --- Textures & Colors --- */
        .envelope>div {
            position: absolute;
            border-radius: 5px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.2);
        }

        /* Back of Envelope (Inside) */
        .back {
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #f06292;
            /* Deep Pink inside */
            z-index: 1;
        }

        /* Paper Texture Overlay (Pseudo) */
        .texture {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0.1;
            background-image: url("data:image/svg+xml,%3Csvg width='100' height='100' viewBox='0 0 100 100' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noise)' opacity='1'/%3E%3C/svg%3E");
            pointer-events: none;
            z-index: 10;
            border-radius: 5px;
        }

        /* Front Pocket */
        .pocket {
            bottom: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #f8bbd0;
            /* Soft Pastel Pink */
            clip-path: polygon(0 100%, 100% 100%, 100% 15%, 50% 55%, 0 15%);
            /* Steep V-shape pocket */
            z-index: 3;
            border-top: 1px solid rgba(255, 255, 255, 0.3);
        }

        /* Top Flap */
        .flap {
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #f8bbd0;
            /* Soft Pastel Pink */
            /* Matches pocket start at 15% */
            clip-path: polygon(0 0, 100% 0, 100% 15%, 50% 55%, 0 15%);
            transform-origin: top;
            transition: transform 0.6s cubic-bezier(0.4, 0, 0.2, 1), z-index 0.2s;
            z-index: 4;
        }

        /* Gold Rim on Flap */
        .flap::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(233, 30, 99, 0.2) 0%, transparent 5%);
            clip-path: polygon(0 0, 100% 0, 100% 15%, 50% 55%, 0 15%);
            pointer-events: none;
        }

        /* --- Wax Seal --- */
        .seal {
            position: absolute;
            top: 55%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 45px;
            height: 45px;
            background: radial-gradient(circle at 30% 30%, #ff8da1, #e91e63);
            /* Pink Seal */
            border-radius: 50%;
            z-index: 5;
            display: flex;
            justify-content: center;
            align-items: center;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            border: 2px solid #c2185b;
            font-size: 24px;
            color: #880e4f;
            transition: transform 0.2s, opacity 0.4s;
        }

        .seal:hover {
            transform: translate(-50%, -50%) scale(1.1);
        }

        /* --- The Letter --- */
        .letter {
            position: absolute;
            bottom: 5px;
            /* Tucked at bottom */
            left: 5%;
            width: 90%;
            height: 80%;
            /* Fits behind steep sides */
            background: #fffdf5;
            background-image: repeating-linear-gradient(transparent, transparent 29px, #e5e5e5 30px);
            border-radius: 3px;
            z-index: 2;
            padding: 25px 20px;
            box-sizing: border-box;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            transition: transform 0.8s 0.6s cubic-bezier(0.4, 0, 0.2, 1), height 0.8s 0.6s ease;
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 2px solid rgba(233, 30, 99, 0.3);
            /* Pink border */
        }

        .letter h2 {
            font-family: 'Dancing Script', cursive;
            color: #d81b60;
            /* Pink text */
            margin: 10px 0 5px;
            font-size: 1.8rem;
        }

        .letter p {
            font-family: 'Lato', sans-serif;
            color: #555;
            font-size: 0.9rem;
            line-height: 1.5;
        }

        /* --- Animation States --- */
        .envelope-wrapper.open {
            animation: none;
            /* Stop float on open */
            cursor: default;
        }

        .envelope-wrapper.open .flap {
            transform: rotateX(180deg);
            z-index: 1;
        }

        .envelope-wrapper.open .seal {
            opacity: 0;
            pointer-events: none;
        }

        .envelope-wrapper.open .letter {
            transform: translateY(-140px);
            z-index: 6;
            /* Bring to front */
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            border-color: #fce4ec;
            /* Light pink border when out */
        }

        /* Fly Away Animation (for Redirect) */
        .envelope-wrapper.fly-away {
            animation: flyUp 1.5s ease-in-out forwards !important;
        }

        @keyframes flyUp {
            0% {
                transform: translateY(0) scale(1);
                opacity: 1;
            }

            100% {
                transform: translateY(-100vh) scale(0.5);
                opacity: 0;
            }
        }

        /* Instruction Text */
        .instruction {
            margin-top: 60px;
            color: rgba(233, 30, 99, 0.6);
            /* Pink instruction */
            letter-spacing: 2px;
            text-transform: uppercase;
            font-size: 0.8rem;
            animation: pulse 2s infinite;
            font-family: 'Lato', sans-serif;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 0.5;
            }

            50% {
                opacity: 1;
            }
        }

        /* --- Heart Zoom Transition --- */
        #heart-transition {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0);
            width: 100px;
            height: 100px;
            background-color: #fce4ec;
            /* Match index.html bg */
            /* Using a mask to make it heart shaped or just a circle is fine, but heart is better */
            clip-path: path('M50 88.9L16.7 55.6C7.2 46.1 7.2 30.9 16.7 21.4s24.7-9.5 34.2 0L50 20.5l-0.9 0.9 0.9-0.9L83.3 21.4c9.5-9.5 24.7-9.5 34.2 0s9.5 24.7 0 34.2L50 88.9z');
            /* Or simple circle if heart is too complex to scale perfectly */
            /* Let's use a simple radial gradient circle that looks soft */
            clip-path: none;
            border-radius: 50%;
            background: radial-gradient(circle, #fce4ec 30%, #f8bbd0 100%);
            z-index: 9999;
            pointer-events: none;
            transition: transform 1.5s cubic-bezier(0.7, 0, 0.3, 1);
        }
    </style>
</head>

<body>

    <div class="container">
        <!-- Transition Element -->
        <div id="heart-transition"></div>

        <div class="envelope-wrapper" id="envelope" onclick="openEnvelope()">
            <div class="envelope">
                <div class="back"></div>
                <!-- Paper Texture Overlay -->
                <div class="texture"></div>

                <div class="letter">
                    <h3>สุขสันต์วันวาเลนไทน์</h1>
                        <p>
                            ขอบคุณที่เข้ามาในชีวิตเค้านะ<br>
                            เค้ารักตะเองที่สุดเลย...<br>
                            <strong>อยู่ด้วยกันไปนานๆนะ ❤️</strong>
                        </p>

                </div>

                <div class="pocket"></div>
                <div class="flap"></div>
                <div class="seal">❤</div>
            </div>
        </div>
        <div class="instruction">Click to Open</div>

        <script>
            // --- 2. 3D Tilt Logic ---
            const envelopeWrapper = document.getElementById('envelope');
            const instruction = document.querySelector('.instruction');
            let isOpen = false;

            document.addEventListener('mousemove', (e) => {
                if (isOpen) return;

                const x = e.clientX;
                const y = e.clientY;
                const width = window.innerWidth;
                const height = window.innerHeight;

                const xRotate = ((y / height) - 0.5) * -20; // Max 20deg tilt
                const yRotate = ((x / width) - 0.5) * 20;

                envelopeWrapper.style.transform = `rotateX(${xRotate}deg) rotateY(${yRotate}deg)`;
            });

            document.addEventListener('mouseleave', () => {
                if (isOpen) return;
                envelopeWrapper.style.transform = 'rotateX(0deg) rotateY(0deg)';
            });

            // --- 3. Open & Redirect Logic ---
            let isTransitioning = false;

            window.openEnvelope = function () { // Global for onclick
                if (isTransitioning) return;

                // STEP 1: OPEN
                if (!isOpen) {
                    isOpen = true;

                    // 1. Reset tilt
                    envelopeWrapper.style.transform = 'rotateX(0deg) rotateY(0deg)';

                    // 2. Add open class for CSS animation
                    envelopeWrapper.classList.add('open');

                    // Update instruction to prompt second click
                    if (instruction) {
                        instruction.style.opacity = '0';
                        setTimeout(() => {
                            instruction.innerText = "แตะอีกครั้งเพื่อไปต่อ... ❤️";
                            instruction.style.opacity = '1';
                        }, 2000); // Show instruction after 2s
                    }

                    // 3. Confetti
                    triggerConfetti();

                    return; // Stop here. Wait for second click.
                }

                // STEP 2: TRANSITION (Clicked again)
                isTransitioning = true;
                if (instruction) instruction.style.opacity = '0';

                // Trigger Heart Zoom Transition
                const heart = document.getElementById('heart-transition');
                heart.style.transform = 'translate(-50%, -50%) scale(50)'; // Scale massively

                // Redirect when screen is full
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 1000);
            }

            function triggerConfetti() {
                const colors = ['#e74c3c', '#f1c40f', '#ffffff'];
                confetti({
                    particleCount: 100, spread: 70, origin: { y: 0.6 }, colors: colors
                });
                setTimeout(() => {
                    confetti({ particleCount: 50, angle: 60, spread: 55, origin: { x: 0 }, colors: colors });
                    confetti({ particleCount: 50, angle: 120, spread: 55, origin: { x: 1 }, colors: colors });
                }, 300);
            }
        </script>
</body>

</html>